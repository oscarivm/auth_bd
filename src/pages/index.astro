---
import { SignIn, SignOut } from "auth-astro/components";
import { getSession } from "auth-astro/server";
import { db } from "astro:db";

const session = await getSession(Astro.request);
console.log(session);
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <main>
      <button id="login-google">Login Google</button>
      <br />
      <button id="login-git">Login Githab</button>
      <br />
      <button id="logout">Logout</button>

      <script>
        const { signIn, signOut } = await import("auth-astro/client");
        const login = document.querySelector("#login-google");
        const logingit = document.querySelector("#login-git");
        const logout = document.querySelector("#logout");
        login?.addEventListener("click", async (event) => {
          event.preventDefault();
          await signIn("google", {
            callbackUrl: "/home",
          });
        });
        logingit?.addEventListener("click", async (event) => {
          event.preventDefault();
          await signIn("github", {
            callbackUrl: "/home",
          });
        });
        logout?.addEventListener("click", async (event) => {
          event.preventDefault();
          await signOut();
        });
      </script>

      <!--   {
        session && (
          <>
            <ul>
              <p>Hola {session.user?.name}</p>
            </ul>
            <img src={session.user?.image} alt="" width="50px" />
          </>
        )
      }-->
    </main>
  </body>

  <!--     <body>
    <header>
      <br /><br /><br />
    </header>
    <main class="">
      <h1>Registro</h1>

      {
        session ? (
          <>
            <p>Hola {session.user?.name}</p>
            <img src={session.user?.image} alt="" />
            <SignOut>Cerrar Sesi√≥n</SignOut>
          </>
        ) : (
          <>
            <SignIn provider="github">Iniciar con Github</SignIn>

            <SignIn provider="google">Iniciar con Google</SignIn>
          </>
  
        )
      }
    </main>
  </body>
   -->
</html>
